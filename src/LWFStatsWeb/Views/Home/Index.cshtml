@model LWFStatsWeb.Models.HomeViewModels.IndexViewModel

@{
    ViewBag.Title = "Home Page";
}

<div class="row">
    <div class="col">
        <img class="img-responsive" src="~/images/clash_header.jpg" />
    </div>
</div>

<div class="row">
    <div class="col-sm-6">
        <h2>Latest War</h2>
        <p><b>@Model.LatestSync.Name</b></p>
        <div id="piechart" style="width:200px"></div>
    </div>
    <div class="col-sm-6">
        <h2>Key numbers</h2>
        <p><b>@Model.Counters.ClanCount</b> clans</p>
        <p><b>@Model.Counters.MemberCount</b> members</p>
        <p><b>@Model.Counters.SyncCount</b> war syncs</p>
        <p><b>@Model.Counters.WarCount</b> war results</p>
    </div>
    <div class="col-sm-6">
        <h2>Clans</h2>
        <p>View all the clans in the alliance.</p>
        <p><a class="btn btn-default" asp-area="" asp-controller="Clans" asp-action="Index">Show clans &raquo;</a></p>
    </div>
    <div class="col-sm-6">
        <h2>War Syncs</h2>
        <p>View status of recent war syncs.</p>
        <p><a class="btn btn-default" asp-area="" asp-controller="Syncs" asp-action="Index">Show war syncs &raquo;</a></p>
    </div>
    <div class="col-sm-6">
        <h2>Following Clans</h2>
        <p>View war clans that are syncing with us.</p>
        <p><a class="btn btn-default" asp-area="" asp-controller="Clans" asp-action="Following">Show following clans &raquo;</a></p>
    </div>
    <div class="col-sm-6">
        <h2>Graph</h2>
        <p>View graph visualization of latest 5 wars.</p>
        <p><a class="btn btn-default" asp-area="" asp-controller="Graphs" asp-action="Index">Show graph &raquo;</a></p>
    </div>
</div>

@section scripts {

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        var options;
        var chart;

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Wars', 'Count'],
                ['LWF', @Model.LatestSync.AllianceMatches],
                ['War', @Model.LatestSync.WarMatches],
                ['DNS', @Model.LatestSync.NotStarted]
            ]);

            options = {
                legend: 'none',
                pieSliceText: 'label',
                chartArea: { left: 10, top: 10, width: '180', height: '180' }
            };

            chart = new google.visualization.PieChart(document.getElementById('piechart'));
            chart.draw(data, options);
        }

        function resizeHandler() {
            chart.draw(data, options);
        }
        if (window.addEventListener) {
            window.addEventListener('resize', resizeHandler, false);
        }
        else if (window.attachEvent) {
            window.attachEvent('onresize', resizeHandler);
        }
    </script>
}